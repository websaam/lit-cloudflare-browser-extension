<iframe 
    src=""
    id="test"
    allow="accelerometer; gyroscope; 
    autoplay; encrypted-media; 
    picture-in-picture;" 
    allowfullscreen="true"
    data-access-control-conditions="W3siY29udHJhY3RBZGRyZXNzIjoiMHhBNTRGNzU3OWZGYjNGOThiZDg2NDlmRjAyODEzRjU3NWY5YjNkMzUzIiwic3RhbmRhcmRDb250cmFjdFR5cGUiOiIiLCJjaGFpbiI6ImV0aGVyZXVtIiwibWV0aG9kIjoiIiwicGFyYW1ldGVycyI6WyI6dXNlckFkZHJlc3MiXSwicmV0dXJuVmFsdWVUZXN0Ijp7ImNvbXBhcmF0b3IiOiI9IiwidmFsdWUiOiIweGRDQTQyYUM0MWU3OWRiMjA5OTVhODRERTJjRTIzNjg1MTliY0I0ZDAifX1d"
    data-encrypted-zip="data:application/octet-stream;base64,O2ga/ynRHEt6dTIsrjB+UyC6ELmTbKrz9oKt43IAbS+3yY0Qcsqbf0+a8OEPaPIQVhQKR7ia/s4Z9lgaHY0g0i4BEB1XuUHinaVa3Jz2Z+Zv8ackF+zdE6GMTZjRBvN8g/G+weCUXy0Yn1yL7atKGxgYv8r1k8VqUwhs6+RL81RXoOd+YgeAZIQWb86Fl4QHp6jHtI1HGzZcl+wNyvTJ0l7jvaZmNLeopU2kgCPYIDMRgOCAh8RaAWguY1UAPZM3kGtUdR3htbAIPR/nDqGhLm9yAT41fvdlU6Tqeyj4Y0tefTL0/ncpnV5/Gghnzg1K8Qg2dLA0cdJcRD4ej+zif4n7GaOedDKMtS8CPkGJLrPyzX1G8ovhGwbheds02JOk8OI+xoOgH8DvM5CwRNFDd0KGJn21AajUvetiAdfYxZno1nrmbRM5fE/8lFn8FTXtbYycI963W38yIDNY523xGlJdltckkiKVU/bFxLH2mz0XdFVoF2JssiGdVeUsbRbB+pQu6OH/LtEQupLzX1DD3AKHdU4Qh48f2TkSJ/B851y5rxalLGDzHyYVyxZkV9l07/+BxJMgS1oTa7MR0/68F/SkmUYSgiBK7Oy/4ta+46xZDIkX2RRC2/gKPqiW5ygmt01rFrcXlCkWcb5r4xPzpXt6g7OUQ09SysKyoQriCR7IrAuczBpz8TUjoAOq1l3xkDWXYycZYlpDGoFWyz7GDogEDaqi4nGFWfFDywPBq8HF4EHSLDO3RBv0/RcjUEao5Ioo2iNp22qDLH4Lh3nXoPVruOLsuB0XEhCnkwmjqTMK15P95cbUSyJHQVSriMitr+Ge9zwd5OYG+mJQP8Au3jdjdDlY/9T9j7sg5q64zw0w3xaJp2bqT5R0sRjKUgjan97mhRbKeXYZ/Uoiv+KWbB1/FmSNtw4BjlJ9ngGushbwJNl93fcO1aizAyHg4UPt"
    data-encrypted-symmetric-key="MTc3LDExOCwxNSwyNTMsMzYsMjI2LDcwLDgzLDM2LDEzLDI0LDE1NCwyMCwyMDMsMTMyLDUwLDE5LDc4LDEyNCwxNSwyMzQsMTEwLDIxOCw1NSw5LDI1MywxNTYsNSwxNjEsMTcsMTg5LDk4LDg3LDQzLDUzLDIxOCwzMiwxNjMsMTc1LDIyNSw3OSw2Myw1OCwxMzIsNzIsMjIyLDI1NSwyMCwxNTcsMCw2MywxMSwyMjksMTY5LDM2LDAsNjEsMTg3LDE4Myw1OCwxNTIsMTE0LDkzLDcxLDE3OSwxMSw0NSw2MCwxNzcsMTM5LDYsMTA3LDIxNiwxMjcsMjIzLDE4NCwxNDMsMjAwLDE4NCwyMTEsMTM2LDE0NiwyNDYsMjI4LDEzNCwyNDMsMjA1LDc0LDEzMSwyMzIsMTcsMTc5LDEyNiwxMjYsODAsMTUwLDc5LDEyMSwxNjksOSw3OCwyMzcsMjcsNjUsMjIzLDEzMywzMywyNywxNCw3MiwzNywyNiw0NiwxNzQsMTcsMjMsMjAwLDE0MCw0MCwyMCwzNCwyMTMsMTkyLDE1MiwyNSwyMTUsNDEsMTI3LDAsMCwwLDAsMCwwLDAsMzIsNzcsMjExLDk4LDM4LDkwLDIwLDI3LDE5MCw2Miw2OCwxMzIsNzYsMjA4LDQxLDM2LDIyMywzMywyMzUsMjAwLDUsMjA2LDE1NSwxMjMsMjA1LDE2MCw4OCw5NywxNTIsMjM5LDgsMjM1LDEyNyw1Miw4NywxMTMsMTMxLDI1MSw1NywxOTUsMTUwLDQxLDE2OCwxMjksMjQwLDc0LDUsMTQzLDE4Mw==">
</iframe>
<button onclick="unlock('test')">Unlock</button>

<iframe 
    src=""
    id="test2"
    allow="accelerometer; gyroscope; 
    autoplay; encrypted-media; 
    picture-in-picture;" 
    allowfullscreen="true"
    data-access-control-conditions="W3siY29udHJhY3RBZGRyZXNzIjoiMHhBNTRGNzU3OWZGYjNGOThiZDg2NDlmRjAyODEzRjU3NWY5YjNkMzUzIiwic3RhbmRhcmRDb250cmFjdFR5cGUiOiIiLCJjaGFpbiI6ImV0aGVyZXVtIiwibWV0aG9kIjoiIiwicGFyYW1ldGVycyI6WyI6dXNlckFkZHJlc3MiXSwicmV0dXJuVmFsdWVUZXN0Ijp7ImNvbXBhcmF0b3IiOiI9IiwidmFsdWUiOiIweGRDQTQyYUM0MWU3OWRiMjA5OTVhODRERTJjRTIzNjg1MTliY0I0ZDAifX1d"
    data-encrypted-zip="data:application/octet-stream;base64,BGRubH23Djj29/HYBz4+q7OWRV86ViAjBcsgCsDhUGK0H1DqzLAB26doi8PyBan/GCQrNJ0IiyVE/kn82yPfcCEOjgCCOwBg3uBo34h+w3eZLa9lRyEYeZlNuYFtJaw3txKtwKdFfXnzari+KrkEOusOycVBwxNc0zXimLwlyLoGKCERR/3RuqV/9N/eT3lG3wrGD9gQKUqqtX4VzkZyyifAdK4vzb1oe+XEtR56WZ94eYF5rNw65xUHXLZstFqtcwivMLgqiHgtUv+WWRCrCp5/Tq6uIPhx1OZbX2bH4x90gVAAhSEqWurgj/MNkXG3qmsLgPhc+HAd6fXaTDTG9tANdH9p2Cc556F5VwoBtG+P8RVGD4IvPPZcIZ4Z5dcsH+xVhBSWFnOYYQTzumoc0KDnmLKootWpBhWWQ2BxMy6vV7pYnwBseSPTqsj8BuS5nZk+GniK/Tld1Fs+SJqxTDiuTyetQ8a0VfEGsux7NC4rEgPYRiLbJ9qenO99x/1XrzO5xaSRxRK0ajLFze866K7EJzrnxOsL+AUGU/FdBu87PNzxzcdlQ5iWOk/RPDnP5YCZkzsifqyHKkiCpkIby5gFQJvPXUmT8bthE0+5obcD0LmSAvV8RFJDmsbYGaQcgY30iDK8YMFtPp9Dl9/J3BQBdlLmvx/zEt6i+BfcQwL0SuYPtYVCMLApB6z0J+zbS9iL5ajngLMuWKyI5we9AvP5vDZqpvippRYDrG71K8utF+7UYdysvty6MSB+BtEBfUz43GmuNjpd+3XbXBQJWKv2Sqjpa15cI0ceKewtOJs6lyXlyLN8rqypgjT7/bp65FPjBi36tpKtCqvrSJ1gTp+ff6HFk0V5VjCYf5jvRFgLDz6MJLeJcYH/vFC6trh2WbqPfAp6M0EKaUjUKO0pHUWiEqelGyk3SNflXKstAO7bOPIOdf3Q7O1g3Fgy+oPi"
    data-encrypted-symmetric-key="NjksMjIwLDE1OCwxNDksMTcsMTA4LDEwNSw1NSwyNTEsMTQ0LDExMiw1OCwxOTAsMTQ4LDQwLDEzMSwxODQsMTY5LDEyNywyMzEsNTEsNzQsMTA4LDExNiwxMjcsNTYsMTgyLDE2MSwyMTAsNDIsMjIzLDE1OSwyNDksMTAsMTE1LDE0MCwxNjEsMTMzLDIwOCw5LDE0MSwyMywyMCw0OSwxODUsNTksMjMzLDcsMzUsMjI4LDE3Myw3OCw5Myw1NiwyMTUsOTcsNjcsMTMwLDE3LDQzLDc4LDUzLDI0Myw2MiwxMDYsMjI4LDIxNywxNDksMTc3LDIxNiwxOTMsMjMsMTQxLDEwLDE0OCwyOSw5OSwxNDgsODAsNCwyMzAsMTM4LDE2NSwxNDUsNzIsMjQxLDIyMCwxMTUsMjA2LDExNCw0MCw1OSwxOTUsMTE3LDI0MSwxMzUsMTAyLDc3LDc0LDE0OCwyLDE2NCw3MiwyMDcsMTk1LDE5MywxNDEsMjAyLDIyMCwyMjMsMjQzLDIxNCwxOTAsMTc5LDE3NCw4MywxNjEsMTI3LDEyOSw4MSw0MywxMzAsMTI5LDMzLDE0NSwyMjMsMTksMTAyLDAsMCwwLDAsMCwwLDAsMzIsNjgsNTksMTAsMTUyLDEwOCwyNDAsMjksOTIsMjI4LDE2MCwyNDUsNzQsMTY4LDY4LDE0NCwyMTUsMTcxLDE3MiwxMjksMjE1LDY5LDI1NSwxMDQsNTQsMjIyLDE3MywyMjAsNDAsMjQ3LDgzLDgzLDEsOCwxOTAsMTI5LDIyNiw2MiwyNTMsMTYsMjAxLDE0NywxNTksMTA2LDI3LDE4LDEzNSwxOTcsMTUz">
</iframe>
<button onclick="unlock('test2')">Unlock</button>

<iframe 
    src=""
    id="test3"
    allow="accelerometer; gyroscope; 
    autoplay; encrypted-media; 
    picture-in-picture;" 
    allowfullscreen="true"
    data-access-control-conditions="W3siY29udHJhY3RBZGRyZXNzIjoiMHhBNTRGNzU3OWZGYjNGOThiZDg2NDlmRjAyODEzRjU3NWY5YjNkMzUzIiwic3RhbmRhcmRDb250cmFjdFR5cGUiOiIiLCJjaGFpbiI6ImV0aGVyZXVtIiwibWV0aG9kIjoiIiwicGFyYW1ldGVycyI6WyI6dXNlckFkZHJlc3MiXSwicmV0dXJuVmFsdWVUZXN0Ijp7ImNvbXBhcmF0b3IiOiI9IiwidmFsdWUiOiIweGRDQTQyYUM0MWU3OWRiMjA5OTVhODRERTJjRTIzNjg1MTliY0I0ZDAifX1d"
    data-encrypted-zip="data:application/octet-stream;base64,dsdzM4yVETs32KXyfnT+RPupnE1SXTRGL41GTGkNrSRonFaI7/Swg1UnSzuOxSF2XDjVObl+Dx/w6TlSSbgcBQu6wwgQfJ5rFfaa6JRQJRYmsdy5tuqPXkiqsSAM9rYRVID35FbhQ8ewUPc+maXpMz1Z2yvQlmLNvcWVmD8cmUmTku/C6MFfCwKB0nFLbWpjjjamR9HkmKpMdcacsDnwNOf49XrwrViFCxeAC6fMGvvO8ujj8y+MuBDU75nyVtmMLvlRoaKKpUMylf6gxgeecmF2eFylRRAuj/wEYQCjS6piemLNvVeagtfL7xhbDVDdqh9W1wzfA32nr64Ut76ThqrBAEcR+j14iSir1CZ1U77opIwPzuNO0Il6UVC0W/UyqbFrYgtz09/iRphhtjKyykDExWgGhAS0MfaIC16MK0xddl3CK6DnEQbwVpm/uKjmuZGoq7TqYytNxLAqkxYYa4Mhm5h3XQPDru6Ie40H0tQwrGjcOy+cKc4RGWbndEJZjtiJ3BlkjPy1mE0/44hXNpVdvz/C5UACpveg9w/UT37Q89xlauYQhN3ROa97QtPNCiEP0EuQMGXQCd2VeHGZtk0NyXKVz5f3B5j+s7v2vOUUsvYLOPV3Ff9KXJYgtVuHOPicVZyI/O8xWEztZfjsi4VCXyRbhBvwDn6fXvg5nyWkCdLsubRgNng4zTXuCxnF2/clTF7NHp9tHEH3f2KKcRoqI1acnc3Or5yoX6Vw+A0mPKKp+vftW6WBlPdfiqubOTHyZrrbwbww6KClak1WniedlXmwYpa3rPEtKrBuo/jVrXHas1y9QTQDwMQOoXQV++rkCrqqKy2ypYcj5BlcmUZi/AJPUYiuDeoFz4VT5Xid9cYgoArGeOPdVldtKaBxoWQudKvGqUh1XnlmNJRSsPOf62HPlmZHG0mxMq6cXcfp5GKhc1EVyM0gXpN/55yd"
    data-encrypted-symmetric-key="MTM1LDIyMiwxMzYsMTA5LDI1MywxMCwyMiw1NSw4LDE0MiwxODcsMjQ3LDIzNywyMzQsMTY0LDIxLDI0LDI1MSw0LDczLDM1LDI1NCw2OCwyMDcsMjE5LDEwNSwxNTUsMTMwLDYyLDE3NCw1NiwyMzMsNzYsMjQxLDczLDI1MCwxMzEsNTcsMTMwLDE0OCw1Nyw5NiwyMzUsNzksMTE2LDEwMiw3MSw5LDE5OCwxNzcsOTgsOTgsMTMyLDE4MCwxNCwxMTcsNjYsMTgwLDI3LDUzLDg0LDE1MCwxOTIsMTI0LDEyMiwxMTYsMTI2LDEyLDEwMiwxNTgsMTQsMTQ4LDExMCw4NCwyNDcsMTM2LDcxLDExNSw5OSwxMTgsODUsMTk4LDE5OSw2MCwyMjcsMTc5LDE2OCwxMDAsMTUzLDM4LDkyLDE5MywzNCw0MCwxMzQsMTc2LDcyLDE1Nyw2MSwyMzMsMjA5LDIxMCw1Niw0Nyw5Miw4MSwyMDcsOTcsOTAsMTA2LDEzNywyMDksMTAyLDQ5LDExNiwxNzYsOTMsMjMzLDIwLDEzOSwxNDYsMTY1LDIyMiwxODMsMzgsMjAxLDE4MiwxMzQsMCwwLDAsMCwwLDAsMCwzMiw2NCwyMTUsNDQsMTEyLDEwOCw1NCwyMzIsMTYsMTM3LDI0MiwyMDEsNjYsNTAsMjIsNywxNjIsMTQ0LDE2MSwxMDQsMjI1LDMsMTUyLDIzMiwxNjcsNDEsMjA3LDE2NiwxMzEsMjAyLDEyNiwxMjEsMjAyLDQsMTA3LDE5NiwyMjcsMTIwLDUzLDE3LDMsMiwyMzQsMTQsMzMsMTUzLDE0MSwxNTIsMTc0">
</iframe>
<button onclick="unlock('test3')">Unlock</button>



<script>

    // ----- helper
    function dataURItoBlob(dataURI) {
        var byteString = atob(dataURI.split(',')[1]);
        var mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0]
        var ab = new ArrayBuffer(byteString.length);
        var ia = new Uint8Array(ab);
        for (var i = 0; i < byteString.length; i++) {
            ia[i] = byteString.charCodeAt(i);
        }
        var blob = new Blob([ab], {type: mimeString});
        return blob;
    }
    function buf2hex(buffer) {
        return [...new Uint8Array(buffer)]
            .map((x) => x.toString(16).padStart(2, "0"))
            .join("");
    }
    
    // ----- unlock
    async function unlock(id){
        var e = document.getElementById(id);
        const chain = 'ethereum';
        const authSig = await LitJsSdk.checkAndSignAuthMessage({chain: chain});
        const accessControlConditions = JSON.parse(atob(e.getAttribute('data-access-control-conditions')));
        const encryptedZip = dataURItoBlob(e.getAttribute('data-encrypted-zip'));
        const toDecrypt = buf2hex(new Uint8Array(atob(e.getAttribute('data-encrypted-symmetric-key')).split(',').map((x) => parseInt(x))));

        const decryptedSymmetricKey = await window.litNodeClient.getEncryptionKey({
            accessControlConditions,
            toDecrypt,
            chain,
            authSig
        });

        const decryptedFiles = await LitJsSdk.decryptZip(encryptedZip, decryptedSymmetricKey);
        const decryptedString = await decryptedFiles["string.txt"].async("text");

        const resourceId = {
            baseUrl: 'iframe.videodelivery.net',
            path: '/' + decryptedString, 
            orgId: "",
            role: "",
            extraData: ""
        }

        const jwt = await litNodeClient.getSignedToken({
            accessControlConditions,
            chain,
            authSig,
            resourceId
        });
        const { verified, header, payload } = await LitJsSdk.verifyJwt({jwt});
        const url = `https://${payload.baseUrl}${payload.path}`;
        e.src = url;
    }
</script>

<script
    onload="LitJsSdk.litJsSdkLoadedInALIT()"
    src="https://jscdn.litgateway.com/index.web.js"
></script>